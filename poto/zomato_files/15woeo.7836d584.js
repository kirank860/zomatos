(this.$WP=this.$WP||[]).push(["15woeo",(e,t)=>{"use strict";var i,l,n,a,r,o,s,u,c,d,m,v,g,h,p,y,f,T,w,I,S,_,b,H,k,N,D,R,O,C,V,z,L,B,E,M,x,A,F,P,j,q,G,J,U,W,K,Y=["Hotels","HotelHighlight","Hotel_Review","HotelsList","HotelsNear","SmartDeals","ShowUserReviews"],Q=["Home","ShowForum","ShowTopic","Tourism"],Z=["Test A","Test B","Test C","Test D"],$="hotel_retargeting",X="reefInterstitialData",ee="interact",te=(e,t)=>(null==e?void 0:e.hotels_retargeting_interstitial_v3_1670906747)&&t.includes(null==e?void 0:e.hotels_retargeting_interstitial_v3_1670906747)||!1,ie=e=>e?new Map(JSON.parse(e)):new Map,le=(e,t,i)=>{var l=ie(e).get(t),n=(new Date).getTime();return l&&(null==l?void 0:l.find((e=>e.key===i&&(!e.ttl||e.ttl>=n))))||null},ne=(e,t,i,l)=>{var n;return((null==(n=le(e,t,i))?void 0:n.value)||l)+0},ae=(e,t,i)=>{var l;return(null==(l=le(e,t,i))?void 0:l.value)||""},re=(e,t,i,l)=>{var n,a;return!!(null!=(n=null==(a=le(e,t,i))?void 0:a.value)?n:l)},oe=(e,t,i)=>{var l,n=e.get(t),a=(new Date).getTime();n=(null==(l=n)?void 0:l.filter((e=>e.key!==i.key&&(!e.ttl||e.ttl>=a))))||[];var r=i;return r.ttl&&(r.ttl+=a),n.push(r),e.set(t,n),e},se=(e,t,i,l)=>{var n=ie(w.get(X)||"");oe(n,e,{key:t,value:i,ttl:l}),w.set(X,JSON.stringify(Array.from(n.entries())))},ue=(e,t,i)=>{var l=ie(I.get(X)||"");oe(l,e,{key:t,value:i}),I.set(X,JSON.stringify(Array.from(l.entries())))},ce=({title:e,primaryInfo:t,secondaryInfo:i,merchandisingText:l,rating:n,reviewCount:a,thumbnail:r,enforceMaxImageSize:o=!1,height:s,width:u,titleSize:c="title-04",bubbleRatingSize:d="medium"})=>N("div",{className:_("CdjmH",{YrEJi:o,DoQvn:!o}),children:[D("div",{className:"_T",children:D(H,{source:r,sizeHint:"200px",height:s,width:u,aspectRatio:"1:1"})}),N("div",{className:"eKoZj e",children:[e&&D(k,{variant:c,children:e}),n&&a&&a>0&&D("div",{className:"MOTTh",children:D(b,{size:d,rating:n,numReviews:a})}),null!=t&&D(k,{variant:"supporting-01",children:t}),null!=i&&D(k,{variant:"supporting-01",children:i}),null!=l&&D(k,{variant:"supporting-03",children:l})]})]}),de=()=>{var[e,t]=d(!1);return m((()=>{if("undefined"!=typeof matchMedia){var e=matchMedia("screen and (max-width: 1023px) and (min-aspect-ratio: 5/3)"),i=()=>{e.matches?t(!0):t(!1)},l="addEventListener"in e;return l?e.addEventListener("change",i):e.addListener(i),i(),()=>{l?e.removeEventListener("change",i):e.removeListener(i)}}}),[]),e},me=({hotel:e})=>{var t="MOBILE"===S(),{rating:i,count:l,name:n,longOnlyHierarchyTypeaheadV2:a,photoSizeDynamic:r}=e,o=de();return D(G,{title:n,primaryInfo:D("span",{}),secondaryInfo:D("div",{className:"Ph",children:a}),merchandisingText:D("span",{}),rating:i,reviewCount:l,thumbnail:r,enforceMaxImageSize:!0,height:t||o?80:130,width:t||o?80:130,titleSize:t||o?"title-05":"title-04",bubbleRatingSize:t||o?"small":"medium"})},ve="hotelsRetargetingInterstitial",ge=e=>{var{params:t}=u(),i=T(),l=x(),a=A(),r=n().formatDate("date_short",new Date(e.visitedTime),"America/New_York");return{trackInteraction:v((({actionType:n,actionSubType:a,additionalClientData:o})=>{l({actionType:n,actionSubType:a,additionalClientData:o,itemName:ve,itemId:e.locationId,page:i,geoId:"geoId"in t&&t.geoId||null,locationId:"locationId"in t&&t.locationId||null,customData:JSON.stringify({lastVisit:r,lastVisitTimestamp:e.visitedTime})})}),[l,e,r,t,i]),trackImpression:v((()=>{a({itemName:ve,itemId:e.locationId,page:i,geoId:"geoId"in t&&t.geoId||null,locationId:"locationId"in t&&t.locationId||null,customData:JSON.stringify({lastVisit:r,lastVisitTimestamp:e.visitedTime})})}),[a,e,r,t,i])}},he=({condition:e,wrapper:t,children:i})=>D(R,{children:e?t(i):i}),pe=["Hotel_Review"],ye=["Test B","Test C"],fe=({lastBrowsedHotel:e,title:t,onInteract:i,abTest:l,children:n})=>{var{localize:r}=a(),{trackInteraction:o,trackImpression:s}=U(e),u=T(),[c,g]=d(!1),[h,p]=d(!0),y="MOBILE"===S(),w=f(),I=de(),b=M((()=>{q.saveValueToLocalStorage($,"sId",w,P),o({actionType:"other",actionSubType:"eligibilibity",additionalClientData:"visible"}),s()})),H=()=>{o({actionType:"click",actionSubType:"cta"}),i()},x=()=>{o({actionType:"click",actionSubType:"dismiss"}),i()},A=v((()=>{p(!0),pe.includes(u)&&y&&b.current&&b.current instanceof HTMLDivElement&&window.pageYOffset>300&&p(!1)}),[y,u,b]);return E("scroll",A),m((()=>{var e=setTimeout((()=>g(!0)),5e3);return()=>{clearTimeout(e)}}),[]),D(R,{children:c&&D(B,{ref:b,onClose:x,hideBackdrop:!0,disableBlockScroll:!0,className:_("IWoER w",{sOYxV:!h}),children:N("div",{className:"xHJZH f e H Gg Ra",children:[D("div",{className:"KRCVG","data-automation":"interstitialClose",children:D(C,{variant:"clear",icon:V,"aria-label":r.string("common_Close"),size:"small",onClick:x})}),N(he,{wrapper:t=>D(z,{theme:"none",href:te(l,ye)?e.urlHH:e.url,onClick:H,target:"_blank",children:t}),condition:!!e.url&&!!e.urlHH,children:[N("div",{className:"moVKP",children:[t&&D(k,{variant:y||I?"title-04":"title-03",marginBottom:"spacing-03",children:t}),D(he,{wrapper:e=>D(L,{theme:"standalone",children:e}),condition:!!e.url&&!!e.urlHH,children:n})]}),D("div",{className:"asSKG f F",children:D(O,{variant:"primary",size:y||I?"small":"medium",children:D("span",{children:r.string("view_deal")})})})]})]})})})},Te={__key:0x91ff20c9c82e,id:"91ff20c9c82e36be6070fd1cc0d6bb97",loc:{},definitions:[]},we={__key:18690689365160,id:"10ffc3e674a8193b60a3c456e94db4e3",loc:{},definitions:[]},Ie={urlTemplate:null,maxHeight:null,maxWidth:null},Se=({onDismiss:e})=>{var[t,i]=d(null),[n,a]=d(!1),r=(()=>{var e,t,i,l,n,a,r,o,s,d,m,v,g,h,p,y,f,T,w,I,S,_,b,H,k,N,D,R,O,C,V,z,L=c(),B=u(),[{data:E,fetching:M}]=F({query:Te,variables:{recentLocationsLimit:10,uid:L}}),x="Hotel_Review"===B.page||"ShowUserReviews"===B.page?B.params.detailId:null,A=null==E||null==(e=E.insightProfile)||null==(t=e.locations)?void 0:t.filter((e=>{var t,i,l,n,a;return"ACCOMMODATION"===(null==e||null==(t=e.location)?void 0:t.placeType)&&(null==e||null==(i=e.location)||null==(l=i.locationV2)?void 0:l.locationId)!==x&&(null==e||null==(n=e.location)||null==(a=n.defaultUrl)?void 0:a.startsWith("/Hotel_Review"))})),P=A&&A.length>0?A[0]:null,j=null!=(i=null==P||null==(l=P.location)||null==(n=l.locationV2)?void 0:n.locationId)?i:-1,[{data:q,fetching:G}]=F({query:we,variables:{locationId:j},pause:-1===j}),J={locationId:j,parentGeoId:null!=(a=null==P||null==(r=P.location)||null==(o=r.locationV2)||null==(s=o.hierarchy)?void 0:s.parentGeoId)?a:-1,rating:null!=(d=null==P||null==(m=P.location)||null==(v=m.reviewSummary)?void 0:v.rating)?d:-1,count:null!=(g=null==P||null==(h=P.location)||null==(p=h.reviewSummary)?void 0:p.count)?g:-1,name:null!=(y=null==P||null==(f=P.location)||null==(T=f.locationV2)||null==(w=T.names)?void 0:w.name)?y:"",longOnlyHierarchyTypeaheadV2:null!=(I=null==P||null==(S=P.location)||null==(_=S.locationV2)||null==(b=_.names)?void 0:b.longOnlyHierarchyTypeaheadV2)?I:"",url:null!=(H=null==P||null==(k=P.location)?void 0:k.defaultUrl)?H:"",urlHH:null!=(N=null==q||null==(D=q.Routing_canonicalize)||null==(R=D[0])?void 0:R.url)?N:"",photoSizeDynamic:null!=(O=null==P||null==(C=P.location)||null==(V=C.thumbnail)?void 0:V.photoSizeDynamic)?O:Ie,visitedTime:null!=(z=null==P?void 0:P.timestamp)?z:-1},U=Object.entries(J).some((([,e])=>-1===e||""===e||JSON.stringify(e)===JSON.stringify(Ie)));return{...J,fetching:M||G,isUndefinedLastBrowsedHotel:U}})(),o=T(),s=f(),p=y({experimentKeys:["hotels_retargeting_interstitial_v3_1670906747"]}),I=g((()=>null===t||r.fetching),[t,r]),{trackInteraction:S}=U(r),_=h(new Date),b=v((()=>{var t=_.current.setSeconds(_.current.getSeconds()+30);q.saveValueToLocalStorage($,ee+r.locationId,t,j),e&&e()}),[r,_,e]),H=v((e=>{a(!0),S(e)}),[S]),k=g((()=>t&&!I),[t,I]);return m((()=>{if(!r.fetching&&!n){var e=!r.isUndefinedLastBrowsedHotel&&(({lastBrowsedHotel:e,page:t,currentSessionId:i,abTest:l,now:n,onControlBucket:a})=>{var r=Q.includes(t)||Y.includes(t),o=Y.includes(t),s=(({lastBrowsedHotel:e,currentSessionId:t,now:i})=>{var{locationId:l,visitedTime:n}=e,a=$,r=w.get(X)||"",o=new Date(i.getTime()).setDate(i.getDate()-30),s=new Date(i.getTime()).setMinutes(i.getMinutes()-30);return!(((e,t,i)=>q.getNumberFromStorage(e,"hotel_retargeting",ee+i,-1))(r,0,l)>n||n>s||n<o||q.getStringFromStorage(r,a,"sId")===t)})({lastBrowsedHotel:e,currentSessionId:i,now:n}),u=te(l,"control"),c=te(l,Z);return s&&r&&u&&a({actionType:"other",actionSubType:"eligibilibity",additionalClientData:"nonVisible"}),null===l?null:(!o||!te(l,["Test A","Test C"]))&&(r&&c&&s||!1)})({lastBrowsedHotel:r,page:o,currentSessionId:s,abTest:p,now:_.current,onControlBucket:H});i(e)}}),[r,o,s,p,_,n,H]),m((()=>{k||I||e&&e()}),[k,I,e]),k?D(W,{lastBrowsedHotel:r,title:D(l,{id:"prices_may_have_changed_interstitial"}),abTest:p,onInteract:b,children:D("div",{className:"aaYTT",children:D("div",{className:"SMGWz f e",children:D(J,{hotel:r})})})}):null},_e=({section:e})=>{switch(e.interstitialType){case"HOTELS_RETARGETING":return D(De,{});case"RECO_EVERGREEN_PROMO":return D(He,{});case"PLANNING_TOOL_DEMAND_TEST":return D(be,{});default:return null}},be=()=>D(Ne,{}),He=()=>{var e="reco-evergreen-interstitials";return i({factory:({dismiss:e})=>D(o,{dismiss:e}),eventTypes:[e],key:e,tier:300}),null},ke=({dismiss:e})=>(m((()=>{p((()=>{null==e||e()}))}),[e]),null),Ne=()=>{var e=u(),t="planningTool-modal-interstitial";return["AttractionsFusion","AttractionProductsFusion","Articles","ArticlesHome"].includes(e.page)&&i({factory:({dismiss:e})=>D(ke,{dismiss:e}),eventTypes:["auto_dismiss_tier_300"],key:"auto_dismiss_tier_300",tier:300}),i({factory:({dismiss:e})=>D(s,{dismiss:e}),eventTypes:[t],key:t,tier:400}),null},De=()=>{var e="reef-interstitial-lithium",t=()=>null;return"en-US"===r()||(i({factory:t,eventTypes:[],key:"skip_optimus_interstitial_non_us",tier:300,skip:!0}),i({factory:t,eventTypes:[],key:"skip_optimus_banner_non_us",tier:400,skip:!0})),i({factory:({dismiss:e})=>(e=>D(K,{onDismiss:e}))(e),eventTypes:[e],key:e,tier:500}),null};return[()=>{j=30*(P=864e5),q={getNumberFromStorage:ne,getBooleanFromStorage:re,getStringFromStorage:ae,saveValueToLocalStorage:se,saveValueToSessionStorage:ue},G=ce,J=me,U=ge,W=fe,K=Se,e("ReefInterstitial",_e)},[e=>i=e.usePopupHierarchyRender,e=>(l=e.default,n=e.useIntlFormatter,a=e.useLocalize,r=e.useLocale),e=>o=e.EvergreenInterstitials,e=>s=e.PlanningToolInterstitials,e=>(u=e.useRoute,c=e.usePageviewUid),e=>(d=e.useState,m=e.useEffect,v=e.useCallback,g=e.useMemo,h=e.useRef,p=e.startTransition),e=>y=e.default,e=>f=e.useSessionId,e=>T=e.default,e=>w=e.default,e=>I=e.default,e=>S=e.useViewportCategory,e=>_=e.default,e=>b=e.BubbleRatingWithReviewCount,e=>H=e.default,e=>k=e.default,e=>(N=e.jsxs,D=e.jsx,R=e.Fragment),e=>(O=e.default,C=e.CircularButton),e=>V=e.default,e=>(z=e.default,L=e.LinkStyle),e=>B=e.ModalBase,e=>E=e.useWindow,e=>M=e.useOnVisible,e=>x=e.default,e=>A=e.default,e=>F=e.useQuery]]},["1xo1is","17thqz","jrer6k","1h80da","fgwvq1","1o4yt4","gugp1d","1al4vi","eqoaya","19b9b1","tp1g68","1ys6v1","fkji80","1bkeq2","34bu7w","1essqv","121h32","jppfwt","1qkjm8","lr6tb6","1uzmmz","ltllz9","13btuy","1r73jw","xg719z","1mqwhq"]]);
