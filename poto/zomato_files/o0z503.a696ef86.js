(this.$WP=this.$WP||[]).push(["o0z503",(l,n)=>{"use strict";var e,i,t,a,o,r,u,s,d,c,g,m,h,f,v,b,p,I,y,C,_,S,T,D,N,w,L,k,M,x,R,E,q,A,F,P={__key:18406443301185,id:"10bd9583b941677aa641607b22b1b952",loc:{},definitions:[]},z={__key:0xf4e01c84824c,id:"f4e01c84824cd7c77262cc5e6d437b63",loc:{},definitions:[]},G={__key:0x8cdbc6e9c88a,id:"8cdbc6e9c88aab673c6bd6008998970e",loc:{},definitions:[]},U={__key:5902564795650,id:"055e4c472502654244b8189100c1e1a3",loc:{},definitions:[]},j={__key:0x5dcb429c6154,id:"5dcb429c6154eb5fc9dd5a100463686f",loc:{},definitions:[]},B=({isDiningClubFilterEnabled:l})=>{var n,i,t,a,o,r,u,s,d,c,g,h,f,v,b,p,I,y,_=m(),L=T(),k=D(),M=N(),x=w(_),R="Restaurant_Review"===L.page,E="geoId"in L.params&&null!=(n=L.params.geoId)?n:null,q="detailId"in L.params&&null!=(i=L.params.detailId)?i:null,[{data:A,fetching:F,error:B}]=S({query:P,variables:{locationId:q},pause:null==q||!k}),O="LIVE"===(null==A||null==(t=A.DiningClub_listDiningClubRestaurants)||null==(a=t.restaurants)||null==(o=a[0])||null==(r=o.offers)||null==(u=r[0])?void 0:u.status)&&"ACTIVE"===(null==A||null==(s=A.DiningClub_listDiningClubRestaurants)||null==(d=s.restaurants)?void 0:d[0].status),[{data:K,fetching:W,error:V}]=S({query:z,variables:{locationId:E},pause:!k||O}),[$]=null!=(c=null==K||null==(g=K.DiningClub_listDiningClubGeos)?void 0:g.geos)?c:[],H=null==$||null==(h=$.primaryLocation)?void 0:h.restaurantCount,J=null!=(f=null==$||null==(v=$.primaryLocation)?void 0:v.locationId)?f:E,Q=null!=H,Y=C(H),[{data:X,fetching:Z,error:ll}]=S({query:G,variables:{geoId:null!=J?J:0},pause:!k||O||!R}),nl=e((()=>{var l,n;return null!=(l=null==X||null==(n=X.DiningClub_filterRestaurantMembers)?void 0:n.restaurants)?l:[]}),[null==X||null==(b=X.DiningClub_filterRestaurantMembers)?void 0:b.restaurants]),el=e((()=>function(l){var n=Math.floor(l/25);return Math.floor(Math.random()*n)}(H||0)),[H]),[{data:il,fetching:tl,error:al}]=S({query:U,pause:!k||null==E||O||!Q||nl.length>10,variables:{request:{sort:{sortField:"NEWEST"},page:{limit:50,offset:25*el},filter:{locationFilter:{parentGeoIds:[null!=J?J:0]}}}}}),ol=e((()=>{var l;return(null==il||null==(l=il.DiningClub_filterRestaurantMembers)?void 0:l.restaurants)||[]}),[null==il||null==(p=il.DiningClub_filterRestaurantMembers)?void 0:p.restaurants]),rl=e((()=>{if(nl.length>10)return nl.filter((l=>{var n;return null==l||null==(n=l.location)?void 0:n.locationId})).sort((()=>Math.random()-.5)).slice(0,10).map((l=>{var n;return`TA-${null==l||null==(n=l.location)?void 0:n.locationId}`}))||[];var l=ol.filter((l=>{var n;return null==l||null==(n=l.location)?void 0:n.locationId})).sort((()=>Math.random()-.5)).slice(0,10-nl.length)||[];return l.unshift(...nl),l.map((l=>{var n;return`TA-${null==l||null==(n=l.location)?void 0:n.locationId}`}))}),[nl,ol]),[{data:ul,fetching:sl,error:dl}]=S({query:j,pause:!k||!rl.length||O||!Q,variables:{locationIds:rl,geoId:null!=E?E:0}}),cl=e((()=>{var l,n,e;return(null==ul||null==(l=ul.RestaurantPresentation_searchRestaurantsByGeo)||null==(n=l.restaurants)||null==(e=n.filter((l=>{var n,e;return Boolean(null==l||null==(n=l.thumbnail)||null==(e=n.photo)?void 0:e.photoSizes)})))?void 0:e.filter(Boolean))||[]}),[null==ul?void 0:ul.RestaurantPresentation_searchRestaurantsByGeo]),[gl]=null!=(I=null==ul?void 0:ul.geos)?I:[],ml=tl||sl||W||Z||F,hl=al||dl||V||ll||B;return{restaurants:cl,geoName:null==gl?void 0:gl.name,geoCountId:null==$||null==(y=$.primaryLocation)?void 0:y.locationId,fetching:ml,fetchedLoggedInUserInfo:x,shouldShowShelf:k&&!ml&&!hl&&!O&&!(l&&M)&&cl.length>0&&(!R||R&&!M)&&Q,geoId:E,isDiningClubMemberLoggedIn:M,restaurantsCount:Y}},O=l=>{var n,e,i,t,a,o,r,u,s,d,c,g,m,h,f,v,b,p,I,y,C,_,S,T,D,N,w,L,k;return{__typename:"LocationInformation",distanceFromCenter:null==l||null==(n=l.location)?void 0:n.distance,thumbnail:{...null==l||null==(e=l.thumbnail)?void 0:e.photo},locationId:null==l?void 0:l.locationId,accommodationCategory:null,accommodationType:null,countryId:null!=(i=null==l||null==(t=l.ta_location)||null==(a=t.hierarchy)?void 0:a.countryId)?i:null,placeType:null!=(o=null==l||null==(r=l.ta_location)?void 0:r.placeType)?o:null,name:null==l?void 0:l.name,parentGeoId:null!=(u=null==l||null==(s=l.ta_location)||null==(d=s.hierarchy)?void 0:d.parentGeoId)?u:null,parent:{locationId:null!=(c=null==l||null==(g=l.ta_location)||null==(m=g.hierarchy)||null==(h=m.parent)?void 0:h.locationId)?c:null,additionalNames:{...null==l||null==(f=l.ta_location)||null==(v=f.hierarchy)||null==(b=v.parent)?void 0:b.names}},geoName:null!=(p=null==l||null==(I=l.ta_location)||null==(y=I.names)?void 0:y.geo)?p:null,isGeo:null!=(C=null==l||null==(_=l.ta_location)?void 0:_.isGeo)?C:null,route:null==l?void 0:l.detailPageRoute,additionalNames:{long:null!=(S=null==l||null==(T=l.ta_location)||null==(D=T.names)?void 0:D.long)?S:null},reviewSummary:{locationId:null==l?void 0:l.locationId,rating:null!=(N=null==l||null==(w=l.reviewSummary)?void 0:w.rating)?N:-1,count:null!=(L=null==l||null==(k=l.reviewSummary)?void 0:k.count)?L:0},socialStatistics:{isSaved:null},businessAdvantageSubscriptions:null,storyboard:null}},K=({item:l,fetchedLoggedInUserInfo:n,locationId:e,index:t,position:a})=>{var o=p(),r=N(),u=r?"DiningClubMainShelf":"DiningClubAcquisitionShelf",s="list"===a?"listShelf":"reviewShelf",d=i((()=>{o({actionType:"scroll",actionSubType:"card",itemName:u,itemType:s,itemPosition:t,itemId:String(e)})}),[t,e,o,u,s]),c=i((()=>{o({actionType:"click",actionSubType:"card",itemName:u,itemType:s,itemPosition:t,itemId:String(e),mixpanel:r?{eventName:"b2c_dc_member_restaurant_list_DC_restaurant_click",restaurantId:String(e)}:void 0})}),[t,r,e,o,u,s]),g=k(d);return M(L,{shelfItemKey:String(e),filterListType:null,marketingCampaignId:0,fetchedLoggedInUserInfo:n,sponsoredPlacementData:null,onClick:c,item:l,ref:g})},W=[{url:"/img2/gemini/dining-club-shelf/dining-club-shelf-desktop-x1.png",width:109,height:130},{url:"/img2/gemini/dining-club-shelf/dining-club-shelf-desktop-x2.png",width:217,height:260}],V=[{url:"/img2/gemini/dining-club-shelf/dining-club-shelf-mobile-x1.png",width:375,height:188},{url:"/img2/gemini/dining-club-shelf/dining-club-shelf-mobile-x2.png",width:750,height:376}],$=({isDiningClubFilterEnabled:l,position:n})=>{var{localize:e}=h(),a="DESKTOP"===r(),m=I(),b=p(),[C,S,T,D]=d({threshold:100}),{restaurants:N,geoName:w,geoCountId:L,fetchedLoggedInUserInfo:k,geoId:F,shouldShowShelf:P,isDiningClubMemberLoggedIn:z,restaurantsCount:G}=E({isDiningClubFilterEnabled:l}),U=z?"DiningClubMainShelf":"DiningClubAcquisitionShelf",j="list"===n?"listShelf":"reviewShelf";t((()=>{P&&N.length&&m({itemName:U,itemType:j,taAnalytics:{items:N.map((({locationId:l},n)=>({pos:n,locationId:l})))}})}),[P,m,U,j,N]);var B=i((()=>{b({actionType:"scroll",actionSubType:"section",itemName:U,itemType:j})}),[b,U,j]),K=i((()=>{b({actionType:"click",actionSubType:"cta",itemName:U,itemType:j})}),[b,U,j]),$=l=>{if(S){var n=S.children[0],e=S.children[1].offsetWidth+n.offsetLeft;S.scrollBy({left:("LEFT"===l?-1:1)*e,behavior:"smooth"})}};if(!P)return null;var H=new URLSearchParams;return H.set("locationId",String(F)),M(y,{onIsVisibleCallback:B,children:x("div",{className:"UAWbf Gr MK",children:[x("div",{className:"yDKae u MK",children:[M("div",{className:"TsIbQ Nl F_",children:M(v,{source:W,lazy:!1})}),M("div",{className:"JPNsN MK",children:M(v,{source:V,lazy:!1})}),x("div",{className:"IJExc u",children:[M("div",{className:"BYfwU",children:M(f,{size:36,iconColor:"secondary",textColor:"secondary",variant:"secondary",primaryOnMobile:!0})}),M("div",{className:"UdWau",children:M(u,{variant:"title-03",elementType:"div",children:M(g,{id:"gemini.b2c.dining.club.shelf_ad.title_dynamic.v2",args:{offerAmount:20,restaurantsCount:G,location:L===+_.NEW_YORK?e.string("gemini.b2c.dining.club.shelf_ad.locations.nyc"):w}})})}),!z&&M("div",{className:"gjpCs",children:M(s,{size:"large",href:`/DiningClub?${H.toString()}`,target:"_blank",onClick:K,children:M(g,{id:"gemini.dc.shelf.cta"})})})]})]}),x("div",{className:"BDSLL _T",children:[M("div",{ref:C,className:o("witup","NidMp _h _T"),children:N.map(((l,e)=>{var i,t,a,o,r=l.topTags&&[...l.topTags],u=null!=(i=null==r?void 0:r.findIndex((l=>{var n;return A.has(null!=(n=null==l?void 0:l.id)?n:0)})))?i:-1,s=u>=0?null==r||null==(t=r.splice(u,1))?void 0:t[0]:null;return M(q,{position:n,index:e,locationId:l.locationId,fetchedLoggedInUserInfo:k,item:{id:String(l.locationId),title:l.name,restaurantItemUxHints:null,priceText:null!=(a=null==s?void 0:s.secondary_name)?a:null,cuisines:null!=(o=null==r?void 0:r.map((l=>{var n;return null==l||null==(n=l.tag)?void 0:n.localizedName})).filter(Boolean))?o:[],promotionPercentage:null,tripAdData:null,object:O(l)}},String(l.locationId))}))}),a&&x(R,{children:[M(c,{show:T,direction:"left",onClick:()=>$("LEFT")}),M(c,{show:D,direction:"right",onClick:()=>$("RIGHT")})]})]})]})})};return[()=>{E=B,q=K,A=new Set([10953,10954,10955]),F=a((l=>{var n,e,i,{filters:t}=b(l);return{isDiningClubFilterEnabled:null!=(n=null==(e=t.find((({identifier:l})=>"diningClub"===l)))||null==(i=e.filterItems.find((({id:l})=>1===l)))?void 0:i.isSelected)&&n}}))($),l("DiningClubShelf",F)},[l=>(e=l.useMemo,i=l.useCallback,t=l.useEffect),l=>a=l.connect,l=>o=l.default,l=>r=l.useViewportCategory,l=>u=l.default,l=>s=l.default,l=>(d=l.useCanScroll,c=l.ScrollArrow),l=>(g=l.default,m=l.useLocale,h=l.useLocalize),l=>f=l.default,l=>v=l.default,l=>b=l.getState,l=>(p=l.useInteractionLogger,I=l.useImpressionLogger),l=>y=l.IsVisibleOnce,l=>(C=l.roundCounter,_=l.LOCATIONS),l=>S=l.useQuery,l=>T=l.useRoute,l=>(D=l.useIsDiningClubFeatureEnabled,N=l.useIsDiningClubMemberLoggedIn),l=>w=l.useOwnerInfo,l=>L=l.ShelfItem,l=>k=l.useOnVisible,l=>(M=l.jsx,x=l.jsxs,R=l.Fragment)]]},["1o4yt4","12mj4n","fkji80","1ys6v1","1essqv","jppfwt","1c4482","17thqz","1m5udk","34bu7w","1jvg6g","16676n","1w0dpw","pe9247","1mqwhq","fgwvq1","1cwn4k","1n9trj","1uxgzg","13btuy","121h32"]]);
