(this.$WP=this.$WP||[]).push(["1tbrqz",(e,i)=>{"use strict";var t,o,a,n,l,r,d,s,c,u,h,m,v,p,g,_,C,E,w,R,T,b,S,I,y,f,k,N,P,A,M,O,D,L,U,W,z,V,B,x,q,H,F,G,j,K,Y,$,J,Q,X,Z,ee,ie,te,oe,ae,ne,le,re,de,se,ce={__key:91548404097567,id:"5343461b221f81c1a5ad0fb4ef3f4fda",loc:{},definitions:[]},ue=e=>{var i=e.map((e=>e.id)),[{data:o,error:a},n]=f({requestPolicy:"network-only",query:ce,variables:{photoIds:i},pause:0===e.length});return{photos:t((()=>{var i=null==o?void 0:o.photos;return a||0===e.length?[]:(null==i?void 0:i.filter(Boolean).map((e=>{var i;return{id:(null==e?void 0:e.id)||0,caption:(null==e?void 0:e.caption)||"",source:(null==e||null==(i=e.photoSizes)?void 0:i.filter((e=>e&&e.url&&e.width&&e.height)).map((e=>({url:(null==e?void 0:e.url)||"",width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}))))||[]}})))||[]}),[e,o,a]),refetch:n}},he="bqVJC",me="CrvPn",ve="SKKIU _S u",pe="sKybN",ge="MZEKf",_e="MfVoE",Ce="NkLhY Gp u",Ee="PZbEs",we="VyMvo e u c",Re="JfecT",Te="Rfrph u",be="iylgP",Se=20,Ie=({imageSize:e,cropCoordinates:i,setCropCoordinates:t,children:n})=>{var[l,r]=o(null),[d]=o(ie.map((()=>a()))),s=(e,i,t)=>e<i?i:e>t?t:e,c=(o,a,n)=>{if(null!==n&&e){var{horizontalPosition:l,verticalPosition:r}=ie[n],d="right"===l?"width":"left",c="bottom"===r?"height":"top",u={...i,[d]:i[d]+o,[c]:i[c]+a,...l&&"left"===l&&{width:i.width-o},...r&&"top"===r&&{height:i.height-a}};if(u.width>Se&&u.height>Se){var h=!l&&!r;u={top:s(u.top,0,e.height-(h?u.height:Se)),left:s(u.left,0,e.width-(h?u.width:Se)),width:h?u.width:s(u.width,Se,e.width-u.left),height:h?u.height:s(u.height,Se,e.height-u.top)},t(u)}}},u=e=>{if(null!=l){var i=d[l].current;if(i){var{horizontalPosition:t,verticalPosition:o}=ie[l],a=e.clientX-i.getBoundingClientRect().left,n=e.clientY-i.getBoundingClientRect().top;c(!t&&o?0:a,!o&&t?0:n,l)}}},h=()=>{null!=l&&r(null)};return e?z("div",{onTouchMove:e=>{null!=l&&1===e.touches.length&&u(e.touches[0])},onTouchEnd:h,onMouseMove:e=>{null!=l&&(e.preventDefault(),u(e))},onMouseLeave:e=>{null!=l&&(u(e),h())},onMouseUp:h,role:"presentation",tabIndex:-1,className:"CCeEQ",children:[U("div",{className:"eLcwp Z1",style:i,children:ie.map((({horizontalPosition:e,verticalPosition:i},t)=>U(te,{ref:d[t],verticalPosition:i,horizontalPosition:e,index:t,handleDragEnd:h,handlePointMovement:c,setMovingPointIndex:r},`${e||""} ${i||""}`)))}),U("div",{className:"cPzFy o",children:U("div",{className:"qeCyD z",style:i})}),U("div",{children:n})]}):U(W,{children:n})},ye=[{name:"3:4",factor:3/4},{name:"1:1",factor:1},{name:"4:3",factor:4/3}],fe=e=>({options:t((()=>{if(!e)return[];var i=e.width/2,t=e.height/2;return ye.map((o=>{var a=Math.min(e.width,e.height),n=a*o.factor,l=Math.max(e.width,e.height);n>l&&(a=(n=l)/o.factor);var r=e.height>e.width?n:a,d=e.height>e.width?a:n;return{...o,value:{left:i-d/2,top:t-r/2,width:d,height:r}}}))}),[e]),isOptionActive:(e,i)=>!!e&&i.value.top===e.top&&i.value.left===e.left&&i.value.width===e.width&&i.value.height===e.height}),ke={width:0,height:0},Ne=({images:e,setImages:i,onClose:a,tracking:n})=>{var{localize:d}=u(),[s,c]=o(0),[h,m]=o(void 0),v=l([]),p=l(null),C=l(null),E=l(null),{options:w,isOptionActive:b}=ae(null==h?void 0:h.imageSize),y="MOBILE"===S(),f=e=>{void 0!==h&&m({...h,cropCoordinates:e})};r((()=>{var e=C.current;!p.current&&h?(p.current=new ResizeObserver((()=>{if(null!=C&&C.current&&void 0!==h){var e,i,{height:t,width:o}=C.current.getBoundingClientRect();0!==o&&0!==t&&(null==(e=h.imageSize)?void 0:e.width)!==o&&(null==(i=h.imageSize)?void 0:i.height)!==t&&m({...h,imageSize:{width:o,height:t},cropCoordinates:{...ne,width:o,height:t}})}})),e&&null!=p&&p.current&&p.current.observe(e)):null!=p&&p.current&&void 0===h&&e&&(p.current.unobserve(e),p.current=null)}),[C,p,h,s,m]),r((()=>{e.some((e=>!(null!=e&&e.processed)))&&(void 0===h?m(e[s]):e[s].photoAttributes.id!==(null==h?void 0:h.photoAttributes.id)&&m(void 0))}),[s,h,e]),r((()=>{void 0!==h&&i((e=>null!==e?e.map((e=>e.photoAttributes.id===h.photoAttributes.id?h:e)):[]))}),[h,i]);var k=()=>{e.forEach(((e,i)=>{e.deleted||A(e,i)}))},N=t((()=>50*e.length+8*(e.length-1)),[e.length]),A=(e,t)=>{var{cropCoordinates:o,photoAttributes:a,imageSize:n,photoSources:l}=e,r=v.current[t];if(r&&o&&n&&(0!==o.top||0!==o.left||o.height!==n.height||o.width!==n.width)){i((e=>e?e.map(((e,i)=>i===t?{...e,processed:!1}:e)):[]));var{url:d,width:s}=l[l.length-1],c=s/n.width,u=o.width*c,h=o.height*c;r.width=u,r.height=h;var m=new Image;m.crossOrigin="Anonymous",m.addEventListener("load",(()=>{var e=r.getContext("2d");e&&(e.clearRect(0,0,o.width,o.height),e.drawImage(m,o.left*c,o.top*c,o.width*c,o.height*c,0,0,u,h),r.toBlob((e=>{if(e){var o=e;o.lastModified=(new Date).getTime(),o.name=`${a.id}_crop.png`,i((e=>e?e.map(((e,i)=>i===t?{...e,file:o,processed:!0}:e)):[]))}}),void 0,1))})),m.setAttribute("src",d)}else i((e=>e?e.map(((e,i)=>i===t?{...e,processed:!0}:e)):[]))},M=e=>{c(e),null!=E&&E.current&&E.current.scroll({left:58*e,behavior:"smooth"})},O=()=>{var e,i;return f({...ne,height:(null==h||null==(e=h.imageSize)?void 0:e.height)||ke.height,width:(null==h||null==(i=h.imageSize)?void 0:i.width)||ke.width})},D=e=>U("div",{className:Re,style:{width:e>1?8*e:8,height:e>1?8:8/e}});return z(W,{children:[y?U(P,{variant:"fixed-height-sticky-footer",stickyHeader:!0,onClose:a,title:z("div",{className:"vuhey",children:[U(_,{onClick:()=>{null!=n&&n.onCropPhotoModalCropReset&&n.onCropPhotoModalCropReset(),O()},dataAttributes:{"data-automation":"reset-crop-button"},children:d.string("user_review_reset_crop")}),U("div",{className:be,children:w.map((e=>U(L,{dataAttributes:{"data-automation":`crop-photo-${e.name}-button`},onClick:()=>{null!=n&&n.onCropPhotoModalCropSizeClick&&n.onCropPhotoModalCropSizeClick(e.name),f(e.value)},marginLeft:"spacing-02",selected:b(null==h?void 0:h.cropCoordinates,e),children:U(R,{variant:"button-03",children:z("div",{className:we,children:[U("div",{className:Re,children:D(e.factor)}),U("span",{children:e.name})]})})},e.name)))})]}),footer:z("div",{className:"CiwQg",children:[e.length>1&&U("div",{ref:E,className:"MCCOq _h",children:U("div",{style:{width:N},className:"dWxey",children:e.map(((e,i)=>e.deleted?null:U("div",{onClick:()=>{M(i)},role:"button",onKeyDown:e=>{"Enter"===e.key&&M(i)},tabIndex:0,children:U("div",{className:I(Ce,{"RUMEo z":i===s}),children:U("div",{className:Ee,children:U(T,{source:e.photoSources,height:"100%"})})})},e.photoAttributes.id)))})}),z("div",{className:Te,children:[U(g,{dataAttributes:{"data-automation":"remove-photo-button"},variant:"secondary",onClick:()=>{var t=e.map(((e,i)=>i===s?{...e,deleted:!0,processed:!0}:e));i(t);var o=t.findIndex((e=>!e.deleted));-1!==o&&c(o)},children:d("user_review_crop_photo_remove")}),U(g,{dataAttributes:{"data-automation":"save-crop-button"},onClick:k,children:d("btn_save")})]})]}),children:U("div",{className:Ce,children:U("div",{ref:C,children:U(oe,{imageSize:null==h?void 0:h.imageSize,cropCoordinates:(null==h?void 0:h.cropCoordinates)||ne,setCropCoordinates:e=>{null!=n&&n.onCropPhotoModalCropSizeChange&&n.onCropPhotoModalCropSizeChange(),f(e)},children:U("div",{className:Ee,children:U(T,{source:null==h?void 0:h.photoSources,height:"100%"})})})})})}):z(P,{onClose:a,children:[U(R,{marginBottom:"spacing-04",variant:"title-02",children:d.string("user_review_crop_photo")}),z("div",{className:"DBsWs",children:[U("div",{className:Ce,children:U("div",{ref:C,children:U(oe,{imageSize:null==h?void 0:h.imageSize,cropCoordinates:(null==h?void 0:h.cropCoordinates)||ne,setCropCoordinates:e=>{null!=n&&n.onCropPhotoModalCropSizeChange&&n.onCropPhotoModalCropSizeChange(),f(e)},children:U("div",{className:Ee,children:U(T,{source:null==h?void 0:h.photoSources,height:"100%"})})})})}),z("div",{className:"OFqce e",children:[U("div",{className:be,children:w.map((e=>U(L,{dataAttributes:{"data-automation":`crop-photo-${e.name}-button`},onClick:()=>{null!=n&&n.onCropPhotoModalCropSizeClick&&n.onCropPhotoModalCropSizeClick(e.name),f(e.value)},marginLeft:"spacing-02",selected:b(null==h?void 0:h.cropCoordinates,e),children:U(R,{variant:"button-03",children:z("div",{className:we,children:[U("div",{className:Re,children:D(e.factor)}),U("span",{children:e.name})]})})},e.name)))}),z("div",{className:Te,children:[U(_,{onClick:()=>{null!=n&&n.onCropPhotoModalCropReset&&n.onCropPhotoModalCropReset(),O()},dataAttributes:{"data-automation":"reset-crop-button"},children:d.string("user_review_reset_crop")}),U(g,{dataAttributes:{"data-automation":"save-crop-button"},variant:"secondary",onClick:k,children:d("btn_save")})]})]})]})]}),U("div",{className:"FPBmc",children:e.map(((e,i)=>e.deleted?null:U("canvas",{ref:e=>{v.current[i]=e}},e.photoAttributes.id)))})]})},Pe=300,Ae=({pendingPhotos:e,setPendingPhotos:i,mobileEditId:a,croppingImages:n,setCroppingImages:s,photoObjects:c,setPhotoObjects:m,onClose:p,onSave:w,tracking:b})=>{var{localize:I}=u(),{photos:y}=v(),{termsOfUse:f}=D(),[k,O]=o(null),[L,W]=o(0),[V,B]=o(void 0),{photos:x}=ee(e),[q,H]=o(c),F=l(null),G=t((()=>0===x.length||y.length>0||(null==n?void 0:n.some((e=>!1===(null==e?void 0:e.processed))))),[y.length,x,n]),j="MOBILE"===S(),[K,Y]=o(null===a),{open:$}=v(),J=e=>{var i=x.find((i=>i.id===e.id));return{photoSources:i?i.source:[],photoAttributes:e}};r((()=>{j&&null!=F&&F.current&&!G&&!K&&F.current.focus()}),[j,L,G,K]),r((()=>{var e;void 0===V?B(q[L]):(null==(e=q[L])?void 0:e.id)!==(null==V?void 0:V.id)&&B(void 0)}),[L,V,q]);var Q=t((()=>null!==n&&!G),[n,G]);r((()=>{Q&&null!=b&&b.onCropPhotoModalOpen&&b.onCropPhotoModalOpen()}),[Q,b]);var X,Z,ie,te,oe=()=>{m(q),w(q)},ae=d((()=>{null!=b&&b.onCropPhotoModalClose&&b.onCropPhotoModalClose(),s(null)}),[b,s]);return r((()=>{ae()}),[j,ae]),r((()=>{H((e=>x.map((i=>({...i,...c.find((e=>e.id===i.id)),...e.find((e=>e.id===i.id))})))))}),[x,c]),Q&&n?U(le,{images:n,setImages:s,onClose:ae,tracking:b}):G?U(P,{onClose:p,children:U("div",{"data-automation":"photo-upload-loading",className:he,children:z("div",{className:"krQgW u z",children:[U(R,{variant:"title-03",marginBottom:"spacing-01",children:I.string("user_review_uploading_photos")}),U(N,{variant:"large","aria-label":"Loading large"})]})})}):j?z(P,{variant:"fixed-height-sticky-footer",stickyHeader:!0,title:z("div",{className:me,children:[U("div",{className:"BhTzD",children:U(R,{variant:"title-02",children:null!==a?I.string("user_review_add_caption_title"):I.string("user_review_add_captions_title",{index:L+1,count:e.length})})}),U(C,{variant:"clear",icon:E,"aria-label":I.string("common_Close"),size:"small",onClick:p})]}),footer:z("div",{className:ge,children:[U("div",{className:_e,children:k&&I("ds_textarea_maximum_characters",{numCount:(null==(X=q.find((e=>e.id===k)))||null==(Z=X.caption)?void 0:Z.length)||0,numLimit:Pe})}),z("div",{className:_e,children:[null===a&&U(_,{onClick:oe,dataAttributes:{"data-automation":"skip-captions-button"},children:I.string("review_collection_gss_skip_cta")}),U(g,{variant:"secondary",dataAttributes:{"data-automation":"next-photo-button"},onClick:L===q.length-1?oe:()=>{W(L+1)},children:L===q.length-1?I.string("tavrs_common_save"):I.string("common_Next")})]})]}),onClose:p,closeButtonPosition:"none",children:[z("div",{className:he,children:[U("div",{onClick:()=>{null!=b&&b.onPhotoClick&&b.onPhotoClick(),s(q.map((e=>J(e))))},role:"button",onKeyDown:e=>{"Enter"===e.key&&(null!=b&&b.onPhotoClick&&b.onPhotoClick(),s(q.map((e=>J(e)))))},tabIndex:0,"data-automation":`crop-photo-${L}-modal-button`,children:U("div",{className:ve,children:U("div",{className:pe,children:U(T,{errorRefetchOptions:{interval:2e3,maxCount:30},source:null==x||null==(ie=x.find((e=>e.id===(null==V?void 0:V.id))))?void 0:ie.source,height:"100%"})})})}),U(R,{marginTop:"spacing-03",variant:"title-03",children:I.string("user_review_add_caption_label")}),U(R,{marginTop:"spacing-02",variant:"input-02",children:U("textarea",{id:`photo-${L}-caption`,className:"OFLxf Q _g z R4 Cj",ref:F,onFocus:()=>{var e;return O(null==(e=q[L])?void 0:e.id)},placeholder:I.string("user_review_add_caption"),rows:5,onChange:e=>{var i=e.target.value;if(e.target.value.length<=Pe){null!=b&&b.onAddCaption&&b.onAddCaption(i);var t=q.map((i=>i.id===q[L].id?{...q[L],caption:e.target.value}:i));H(t)}},value:(null==(te=q[L])?void 0:te.caption)||"",maxLength:Pe})})]}),K&&z(A,{mobileContainerStyle:"inset",onClose:p,children:[U(R,{variant:"supporting-02",children:U(h,{id:"user_review_photo_upload_terms_with_url",args:{link:`"${f}"`,class:'"CyRID _F Wb"',target:'"_blank"'}})}),U(g,{marginTop:"spacing-04",onClick:()=>Y(!1),children:I.string("common_accept")})]})]}):U(P,{variant:"fixed-height-sticky-footer",stickyHeader:!0,title:U("div",{className:me,children:U(R,{variant:"title-02",children:I.string("user_review_add_photos")})}),footer:z("div",{className:ge,children:[z("div",{className:"PJWoP",children:[U(g,{variant:"secondary",dataAttributes:{"data-automation":"add-more-photos-button"},onClick:()=>{null!=b&&b.onAddMoreClick&&b.onAddMoreClick(),$()},children:U("div",{className:"OGMYW u",children:I.string("user_review_add_more_photos")})}),U(g,{dataAttributes:{"data-automation":"attach-photos-button"},onClick:oe,children:1===x.length?I.string("user_review_attach_photo"):I.string("user_review_attach_photos",{number:x.length})})]}),U(R,{variant:"supporting-02",children:U(h,{id:"user_review_photo_upload_terms_with_url",args:{link:`"${f}"`,class:'"CyRID _F Wb"',target:'"_blank"'}})})]}),onClose:p,children:U("div",{className:he,children:U("div",{className:"SPevl",children:q.map(((t,o)=>{var a,n;return z("div",{children:[U("div",{onClick:()=>{null!=b&&b.onPhotoClick&&b.onPhotoClick(),s([J(t)])},role:"button",onKeyDown:e=>{"Enter"===e.key&&(null!=b&&b.onPhotoClick&&b.onPhotoClick(),s([J(t)]))},tabIndex:0,"data-automation":`crop-photo-${o}-modal-button`,children:z("div",{className:ve,children:[U("div",{className:"wtJbL",children:U(C,{dataAttributes:{"data-automation":`delete-photo-${o}-modal-button`},variant:"dark",icon:E,"aria-label":I.string("b2b_delete_photo"),size:"small",onClick:t=>{null!=b&&b.onDeletePhoto&&b.onDeletePhoto(),((t,o)=>{t.preventDefault(),t.stopPropagation();var a=[...e],n=[...q];a.splice(o,1),0===n.length&&w(n),i(a)})(t,o)}})}),U("div",{className:pe,children:U(T,{errorRefetchOptions:{interval:2e3,maxCount:30},source:null==x||null==(a=x.find((e=>e.id===t.id)))?void 0:a.source,height:"100%"})})]})}),U(M,{id:`photo-${o}-caption`,marginTop:"spacing-02",placeholder:I.string("user_review_add_caption"),value:null==(n=q[o])?void 0:n.caption,onBlur:()=>O(null),onFocus:()=>O(t.id),onChange:e=>{var i=e.target.value;null!=b&&b.onAddCaption&&b.onAddCaption(i);var t=q.map((i=>i.id===q[o].id?{...q[o],caption:e.target.value}:i));H(t)},maxLength:Pe,characterCountType:k===t.id?"max":void 0,variant:"two-line"})]},t.id)}))})})})},Me=({onPhotosUploadedWithObject:e,photoObjects:i,tracking:a})=>{var[n,l]=o([]),[c,h]=o(null),{photos:m}=ee(i||[]),[p,g]=o(i),[f,k]=o(null),N="MOBILE"===S(),{localize:P}=u(),A=b(),{photos:M,open:O,uploadFiles:D}=v((e=>{null!==c?L(e.map((e=>e.mediaId))):0===n.length?l([...N?[]:p,...e.map((({mediaId:e})=>({id:e,caption:""})))]):l([...n,...e.map((({mediaId:e})=>({id:e,caption:""})))])})),L=d(((i=[])=>{if(c){null!=a&&a.onCropPhotoModalSave&&a.onCropPhotoModalSave();var t=0,o=[],r=n.map((e=>{var a=c.find((i=>i.photoAttributes.id===e.id));if(null!=a&&a.deleted)return null;if(null!=a&&a.file){var n=i[t++];return o.push({id:n,caption:a.photoAttributes.caption}),{id:n,caption:a.photoAttributes.caption}}return e})).filter(Boolean);o.length>0&&g(p.concat(o)),f&&e&&0===r.length&&k(null),l(r),h(null)}}),[a,c,n,e,p,f]),V=()=>{l([]),k(null)},B=()=>{null!=a&&a.onDropzoneClick&&a.onDropzoneClick(),A({flowOrigin:"login",isFullWidthMobile:!0,extraQueryParams:{contextualMessage:"user_review_reg_contextual_message"}}).then((()=>O()))},x=t((()=>M.length>0||n.length>0),[M,n]);return r((()=>{null!=a&&a.onModalOpen&&x&&a.onModalOpen()}),[x,a]),r((()=>{V()}),[N]),r((()=>{if(0===M.length&&c&&c.every((e=>null==e?void 0:e.processed))){var e=c.map((e=>null==e?void 0:e.file)).filter(Boolean);e.length>0?D(e):L()}}),[L,c,M,D]),r((()=>{0!==(null==i?void 0:i.length)&&g((e=>i.concat(e.filter((e=>!i.find((i=>i.id===e.id)))))))}),[i]),z(W,{children:[x&&U(re,{pendingPhotos:n,setPendingPhotos:l,mobileEditId:f,croppingImages:c,setCroppingImages:h,photoObjects:p,setPhotoObjects:g,tracking:a,onSave:i=>{null!=a&&a.onUploadModalSave&&a.onUploadModalSave(),(i=>{if(e)if(null!==f&&N){var t=f===i[0].id?[...p]:[...p.filter((e=>e.id!==i[0].id))],o=t.findIndex((e=>e.id===f));t.splice(o,1,i[0]),g(t),e(t)}else g(i),e(N?p.concat(i.filter((e=>!p.find((i=>e.id===i.id))))):i);V()})(i)},onClose:()=>{null!=a&&a.onCloseClick&&a.onCloseClick(),V()}}),U(R,{variant:"title-03",marginBottom:"spacing-01",children:P("tavrs_common_photos_v2")}),U(R,{color:"placeholderText",variant:"body-01",marginBottom:"spacing-04",children:P("phoenix_war_optional_tag")}),p&&z("div",{className:N?"pkdPP _h":void 0,children:[U("div",{className:"kEkhq",children:p.map(((i,t)=>{var o;return s("div",{...N&&{role:"button",onKeyDown:e=>{"Enter"===e.key&&(l([i]),k(i.id))},tabIndex:0,onClick:()=>{l([i]),k(i.id)}},key:i.id},z("div",{className:"mQdMo j u",children:[U("div",{className:"lqysj",children:U(C,{variant:"dark",icon:E,"aria-label":P.string("b2b_delete_photo"),size:"small",onClick:i=>{i.stopPropagation(),(i=>{var t=p?[...p]:[];t.splice(i,1),g(t),e&&e(t)})(t)},dataAttributes:{"data-automation":`delete-photo-${t}-button`}})}),U("div",{className:"fpKaJ",children:U(T,{source:null==m||null==(o=m.find((e=>e.id===i.id)))?void 0:o.source,height:"100%"})})]}),N&&U(R,{variant:"body-01",children:U("div",{className:"TauMP W j u",children:U(_,{marginY:"spacing-03",trailing:!0,icon:i.caption?y:void 0,onClick:()=>{l([i]),k(i.id)},dataAttributes:{"data-automation":`add-caption-${t}-button`},children:i.caption?U("span",{className:"fyOGB",children:i.caption}):P.string("user_review_add_caption_title")})})}))}))}),(null==p?void 0:p.length)>0&&!N&&U(_,{marginTop:"spacing-03",onClick:()=>{l(p)},dataAttributes:{"data-automation":"edit-captions-button"},children:P.string("user_review_edit_captions_v2")})]}),z("div",{className:I("WrPIn e u _S",{BPcQk:N,PMLPB:(null==m?void 0:m.length)>0}),role:"button",onKeyDown:e=>{"Enter"===e.key&&B()},tabIndex:0,onClick:B,"data-automation":"photo-upload-trigger",children:[U(w,{size:18}),N?U(R,{marginTop:(null==m?void 0:m.length)>0?void 0:"spacing-02",variant:"supporting-03",children:(null==m?void 0:m.length)>0?P.string("user_review_add_more_photos"):P.string("user_review_add_photos")}):z(W,{children:[U(R,{marginTop:"spacing-02",variant:"supporting-03",children:P.string("user_review_click_add_photos")}),U(R,{marginTop:"spacing-01",variant:"supporting-02",children:P.string("user_review_drag_drop")})]})]})]})},Oe=({...e})=>U(c,{children:U(p,{children:U(Me,{...e})})}),De="YUuQs",Le="o W q",Ue=e=>{var i,{title:t,subtitle:a,thumbnails:n,rating:l,variant:r,useCardStyle:d,upvotes:s,menuActions:c,onRatingClick:h,onCardClick:m,link:v}=e,{localize:p}=u(),[g,_]=o(l||0),E=U("div",{className:d?"UEqmh Gi Pj PX Pw PJ":void 0,children:z("div",{className:"BlJbG",children:[n&&"imageLeft"===r&&U("div",{className:"uSrYC",children:U(T,{source:null==(i=n[0])?void 0:i.source,height:"100%",width:"100%",aspectRatio:"1:1"})}),z("div",{className:"I",children:[z("div",{className:De,children:[U("div",{className:"o",children:U(R,{variant:"title-04",children:U("div",{className:Le,children:t})})}),c&&U("div",{className:"xgqOf",children:U("div",{className:"BMEVx",children:U(H,{options:c,menuVariant:"trailing-top-caret",label:p.string("sng_review_options"),mode:"menu",fullscreenMobile:!0,trigger:({active:e,onKeyDown:i,ariaAttributes:t,ref:o,onClick:a})=>U(C,{ref:o,ariaAttributes:t,onKeyDown:e=>{e.preventDefault(),i&&i(e)},variant:"clear",icon:B,size:"small","aria-label":e?p.string("sng_close_options_menu"):p.string("sng_open_options_menu"),onClick:e=>{e.preventDefault(),a&&a(e),m&&m()}})})})})]}),U("div",{className:De,children:U("div",{className:"o",children:U(R,{marginY:"spacing-01",variant:"supporting-01",children:U("div",{className:Le,children:a})})})}),h&&U("div",{onClick:e=>e.stopPropagation(),role:"presentation",children:U(x,{name:"Traveler rating",rating:g,showRatingLabel:!1,onClick:(e,i)=>{_(i),h&&h(i),m&&m()},size:"large"})}),void 0!==s&&s>0&&U(R,{marginY:"spacing-01",variant:"supporting-01",children:z("span",{className:"SYFFK u",children:[U(V,{size:14}),p.string("user_review_found_this_helpful",{number:s})]})}),n&&"imagesBelow"===r&&U("div",{className:"yYpQb Mk",children:n.map((e=>U(T,{source:e.source,width:50,height:50},e.id)))})]})]})});return v?U(F,{theme:"none",onClick:()=>{m&&m()},href:v,children:E}):E},We=({title:e,items:i,options:a,desktopLayoutColumns:n="three-columns",initialItemsToShow:l,itemsToShowMultiplier:d,onShowMoreClick:s})=>{var c,{localize:h}=u(),m="MOBILE"===S(),[v,p]=o(l),g=t((()=>v?i.slice(0,v):i),[i,v]),C=void 0!==v&&i.length>v;return r((()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})}),[m]),z(W,{children:[Array.isArray(e)?(c=e,U("div",{className:"IZNJo _T",children:U("div",{className:"nYPXR",children:c.map((e=>U("span",{children:U(R,{marginBottom:"spacing-04",variant:"title-03",children:e})},e)))})})):U(R,{marginBottom:"spacing-04",variant:"title-03",children:e}),U("div",{className:I("nKQoO",{PLXqA:"two-columns"===n,woNgg:"three-columns"===n}),children:g.map((e=>U(de,{...a,...e},e.id)))}),d&&C&&z(_,{onClick:()=>{s&&s(),p(v+d)},marginTop:"spacing-04",children:[h("airm_mobile_show_more")," "]})]})},ze={__key:0xd91b3ac14eae,id:"d91b3ac14eae938f8f1790116e2e973c",loc:{},definitions:[]},Ve={__key:0xc9cf366ef9b9,id:"c9cf366ef9b9d8a3fd869b9490a2c975",loc:{},definitions:[]},Be=({desktopLayoutColumns:e,hideBorder:i,title:t,initialItemsToShow:o,itemsToShowMultiplier:a,onCardClick:n})=>{var l,r,d,s,c=m(),u=G(),h="MOBILE"===S(),[,v]=k(Ve),[{data:p}]=f({query:ze,variables:{taUnique:u}}),g=(null==p||null==(l=p.ReviewsProxy_getSuggestedLocationsToReview)||null==(r=l.flat())||null==(d=r.filter(Boolean))||null==(s=d.filter((e=>null==e?void 0:e.locationId)))?void 0:s.map((e=>{var i,t,o,a,n,l,r;return{id:e.locationId,title:U(F,{theme:"standalone",target:"_blank",href:(null==e||null==(i=e.location)?void 0:i.url)||"",children:null==e||null==(t=e.location)?void 0:t.localizedName}),subtitle:null==e||null==(o=e.location)||null==(a=o.parent)||null==(n=a.additionalNames)?void 0:n.long,writeUserReviewUrl:null==e||null==(l=e.location)?void 0:l.writeUserReviewUrl,thumbnails:null!=e&&null!=(r=e.location)&&r.thumbnail?[{id:e.location.thumbnail.id||0,source:e.location.thumbnail.photoSizes}]:[],onRatingClick:i=>_(i,e.locationId)}})))||[],_=(e,i)=>{var t=g.find((e=>e.id===i));v({locationId:i,rating:e,locale:c,ipAddress:"",mobile:h,taUnique:u}).then((()=>{window.location.href=(null==t?void 0:t.writeUserReviewUrl)||""}))};return 0===g.length?null:U("div",{className:i?void 0:"FYdsq B1 Z BB Pk PY Px PK",children:U(se,{title:t,itemsToShowMultiplier:a,initialItemsToShow:o,items:g,options:{variant:"imageLeft",onCardClick:n},desktopLayoutColumns:e})})},xe=(e,i)=>{var{logInteraction:o,logImpression:a}=K(e,i),{params:n}=j(),l="geoId"in n?n.geoId:0;return t((()=>({logImpression:(e,i,t={})=>a(e,((e,i)=>{switch(e){case"GLOBAL_NAVIGATION":return{itemType:"WriteReview",itemName:"GlobalNav",customData:JSON.stringify({})};case"POI_WRITE_REVIEW_HEADER":return{itemType:"WriteReview",itemName:"PoiHeader",customData:JSON.stringify({geoId:i})};case"POI_WRITE_REVIEW_SECTION":return{itemType:"WriteReview",itemName:"PoiReivewSection",customData:JSON.stringify({geoId:i})};case"USER_REVIEW_LANDER":return{itemType:"userReviewLander",itemId:"userReviewLanderPage",itemName:"userReviewLanderPage"};case"USER_REVIEW_EDIT":return{itemType:"userReviewEdit",itemId:"userReviewEditPage",itemName:"userReviewEditPage"};case"USER_REVIEW_EDIT_TRUST_MODAL":return{itemType:"userReviewEdit",itemId:"userReviewEditTrustSafetyModal",itemName:"userReviewEditTrustSafetyModal"};case"USER_REVIEW_PHOTO_UPLOAD_MODAL":return{itemType:"userReviewEdit",itemId:"userReviewPhotoModal",itemName:"userReviewPhotoModal"};case"USER_REVIEW_CROP_PHOTO_MODAL":return{itemType:"userReviewEdit",itemId:"userReviewCropPhotoModal",itemName:"userReviewCropPhotoModal"};case"USER_REVIEW_SUBMIT":return{itemType:"userReviewSubmit",itemId:"userReviewSubmitPage",itemName:"userReviewSubmitPage"};case"USER_REVIEW_CELEBRATION":return{itemType:"userReviewCelebration",itemId:"userReviewCelebrationPage",itemName:"userReviewCelebrationPage"};default:return{}}})(e,l),i,t),logInteraction:(e,i,t={})=>o(e,((e,i)=>{switch(e){case"GLOBAL_NAVIGATION":return{itemType:"WriteReview",itemName:"GlobalNav",customData:JSON.stringify({})};case"POI_WRITE_REVIEW_HEADER":return{itemType:"WriteReview",itemName:"PoiHeader",customData:JSON.stringify({geoId:i})};case"POI_WRITE_REVIEW_SECTION":return{itemType:"WriteReview",itemName:"PoiReivewSection",customData:JSON.stringify({geoId:i})};case"USER_REVIEW_LANDER_DRAFT":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"draft"};case"USER_REVIEW_LANDER_DRAFT_SHOW_MORE":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"showMore"};case"USER_REVIEW_LANDER_SUGGESTION":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"beenThere"};case"USER_REVIEW_LANDER_RECENT_REVIEWS_MENU":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"recentReview"};case"USER_REVIEW_LANDER_LEARN_MORE":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"learnMore"};case"USER_REVIEW_LANDER_ADD_LISTING":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"addListing"};case"USER_REVIEW_LANDER_RECENT_REVIEWS_SEE_ALL":return{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"seeAll"};case"USER_REVIEW_EDIT_BUBBLE_RATING":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"bubbleRating"};case"USER_REVIEW_EDIT_TRAVEL_DATE":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"visitDate"};case"USER_REVIEW_EDIT_REVIEW_TYPE":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"reviewType"};case"USER_REVIEW_EDIT_MEAL_TYPE":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"mealType"};case"USER_REVIEW_EDIT_TEXT_START":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"textBodyStart",itemId:"textBodyStart"};case"USER_REVIEW_EDIT_TEXT_COMPLETE":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"textBodyComplete",itemId:"textBodyComplete"};case"USER_REVIEW_EDIT_TITLE_START":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"TitleStart",itemId:"TitleStart"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_START":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"photoStart",itemId:"photoStart"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_CLOSE":return{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"closeCTA"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_ADD_MORE":return{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"addMorePhotosCTA"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_DELETE":return{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"deletePhotoCTA"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_ADD_CAPTION":return{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"addCaption"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_EDIT":return{actionType:"click",actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"photoEdit"};case"USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CLOSE":return{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"closeCTA"};case"USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_SIZE":return{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize"};case"USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_MANUAL":return{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Manual"};case"USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_RESET":return{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Reset"};case"USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_SAVE":return{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Save"};case"USER_REVIEW_EDIT_PHOTO_UPLOAD_ATTACH":return{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"photoUpload"};case"USER_REVIEW_EDIT_TRUST_MODAL_ACCEPT":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"termsAgree",itemId:"termsAgree"};case"USER_REVIEW_EDIT_TRUST_MODAL_DECLINE":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"termsDecline",itemId:"termsDecline"};case"USER_REVIEW_EDIT_DRAFT_SUBMIT":return{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"submitClick",itemId:"submitClick"};case"USER_REVIEW_EDIT_ADDITIONAL_RATING":return{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClickRate",itemName:"rateClick"};case"USER_REVIEW_EDIT_TIPS":return{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClick",itemName:"tipsClick",itemId:"tipsClick"};case"USER_REVIEW_EDIT_TAGS":return{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClickTag"};case"USER_REVIEW_EDIT_REVIEW_SUBMIT":return{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClick",itemName:"submitClick",itemId:"submitClick"};default:return{}}})(e,l),i,t)})),[l,o,a])},qe=()=>{var e=!!$().startsWith("hare.tripadvisor");return U(Y,{config:{samplingRate:1,startDate:"2022-09-19",endDate:"2023-01-01",locations:!0,eventName:"WAR Rewrite 2022",trackingId:e?2843497:1441007}})},He="SopVu",Fe={__key:0xf83849d49d0e,id:"f83849d49d0ee97d0e3259065c7b060e",loc:{},definitions:[]},Ge=({locationId:e,setLocationId:i})=>{var a,{localize:n}=u(),[l,r]=o(),[s,c]=o(!1),[h,m]=o(!1),v=d((e=>{null!==e&&m(!0)}),[]),[{data:p}]=f({query:Fe,variables:{locationId:e},pause:!e}),_=t((()=>{var e,i;return null==p||null==(e=p.locations)||null==(i=e.map((e=>{var i,t,o,a,n,l,r,d,s,c,u,h,m;return{id:null==e?void 0:e.locationId,poiName:null==e?void 0:e.localizedName,poiLocation:null==e||null==(i=e.parent)||null==(t=i.additionalNames)?void 0:t.long,street:null==e||null==(o=e.localizedStreetAddress)?void 0:o.street,image:null==e||null==(a=e.thumbnail)?void 0:a.photoSizes,writeUserReviewUrl:null==e?void 0:e.writeUserReviewUrl,rating:null==e||null==(n=e.reviewSummary)?void 0:n.rating,reviewCount:null==e||null==(l=e.reviewSummary)?void 0:l.count,award:null!=e&&null!=(r=e.locationV2)&&null!=(d=r.bestAwardForActiveYearV2)&&d.awardType?{type:null==e||null==(s=e.locationV2)||null==(c=s.bestAwardForActiveYearV2)?void 0:c.awardType,year:null==e||null==(u=e.locationV2)||null==(h=u.bestAwardForActiveYearV2)?void 0:h.year}:null,relatedLocations:(null==e||null==(m=e.relatedLocations)?void 0:m.map((e=>{var i,t,o;return{id:null==e?void 0:e.locationId,poiName:null==e?void 0:e.localizedName,poiLocation:null==e||null==(i=e.parent)||null==(t=i.additionalNames)?void 0:t.long,image:null==e||null==(o=e.thumbnail)?void 0:o.photoSizes,writeUserReviewUrl:null==e?void 0:e.writeUserReviewUrl}})))||[]}})))?void 0:i[0]}),[p]),C=t((()=>(null==_?void 0:_.relatedLocations.map((e=>{var i;return{displayName:e.poiName||"",value:(null==(i=e.id)?void 0:i.toString())||"",customContent:z("div",{className:"GaLho f",children:[U("div",{className:He,children:U(T,{source:e.image,height:"100%",width:"100%",aspectRatio:"1:1"})}),z("div",{children:[U(R,{variant:"supporting-03",children:e.poiName}),U(R,{variant:"supporting-02",children:e.poiLocation})]})]})}})))||[]),[_]),E=t((()=>null==_?void 0:_.relatedLocations.find((e=>e.id===Number(l)))),[l,_]),w=s?null==_?void 0:_.writeUserReviewUrl:null==E?void 0:E.writeUserReviewUrl,b=()=>{i(null)};return _&&null!==e?z(P,{onClose:b,title:n.string("activity_selection_modal_title"),children:[!h&&U("input",{ref:v}),z("div",{className:"bhIWD",children:[z("div",{className:"XiCpG f Mn MK Px",children:[z("div",{className:He,children:[U(T,{source:_.image,height:"100%",width:"100%",aspectRatio:"1:1"}),_.award&&U("div",{className:"AydSl",children:U(Q,{size:"small",color:_.award?"green":"yellow",year:(null==_||null==(a=_.award)?void 0:a.year)||void 0})})]}),z("div",{children:[U(R,{variant:"title-04",marginBottom:"spacing-01",children:_.poiName}),_.rating&&_.reviewCount&&z("div",{className:"FGKgp f u",children:[(null==_?void 0:_.rating)>0&&U(q,{size:"small",rating:_.rating}),U(R,{variant:"supporting-02",children:_.reviewCount})]}),z(R,{variant:"supporting-01",marginTop:"spacing-01",children:[_.street,_.street&&", ",_.poiLocation]})]})]}),U(R,{marginBottom:"spacing-04",variant:"title-04",children:n.string("activity_selection_modal_subtitle")}),U(O,{disabled:s,marginBottom:"spacing-04",value:l||"",menuLabel:n.string("tour_selector_placeholder"),dropdownOptions:C,onChange:r}),U(J,{value:"close-button",checked:s,onToggle:(e,i)=>c(i),label:U(R,{variant:"body-01",children:n.string("tour_selector_other_checkbox_label")})}),U(g,{marginTop:"spacing-04",disabled:!E&&!s,onClick:()=>{var e;(e=w)&&(window.location.href=e),b()},children:n.string("button_continue")})]})]}):null},je=()=>{var e="MOBILE"===S(),{os:i}=X(),t="IOS"===i.family;return U("meta",e&&t?{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"}:{})},Ke=()=>{var e="write_a_review_form_web_experiences_1666008828",i=Z({experimentKeys:[e]});return null!=i&&"test"===i[e]};return[()=>{ee=ue,ie=["top",void 0,"bottom"].flatMap((e=>["left",void 0,"right"].map((i=>({verticalPosition:e,horizontalPosition:i}))))),(te=n((({index:e,horizontalPosition:i,verticalPosition:t,handleDragEnd:o,setMovingPointIndex:a,handlePointMovement:n},l)=>U("div",{draggable:!1,className:I("zrgMr _S",{SdESB:"top"===t,uaVlO:"bottom"===t,zeIHb:"left"===i,czGRH:"right"===i}),role:"button",ref:l,tabIndex:0,onTouchStart:()=>{a(e)},onTouchEnd:o,onMouseDown:i=>{i.preventDefault(),a(e)},onKeyDown:o=>{["ArrowDown","ArrowLeft","ArrowUp","ArrowRight"].includes(o.key)&&o.preventDefault();var a=!i&&t?0:1,l=!t&&i?0:1;switch(o.key){case"ArrowDown":n(0,a,e);break;case"ArrowUp":n(0,-a,e);break;case"ArrowLeft":n(-l,0,e);break;case"ArrowRight":n(l,0,e)}},onKeyUp:o,children:U("div",{className:"TPBnT"})})))).displayName="CropButton",oe=Ie,ae=fe,ne={top:0,left:0,...ke},le=Ne,re=Ae,e({ActivitySelectionModal:Ge,PhotoUpload:Oe,ReviewCard:de=Ue,ReviewCards:se=We,ReviewSuggestions:Be,Viewport:je,WarHotjar:qe,useFetchPhotoElements:ee,useUserReviewTracking:xe,useWarExperiencesToggle:Ke})},[e=>(t=e.useMemo,o=e.useState,a=e.createRef,n=e.forwardRef,l=e.useRef,r=e.useEffect,d=e.useCallback,s=e.createElement),e=>c=e.ErrorBoundary,e=>(u=e.useLocalize,h=e.UnsafeLocalize,m=e.useLocale),e=>v=e.useCustomPhotoUpload,e=>p=e.ToastProvider,e=>(g=e.default,_=e.BorderlessButton,C=e.CircularButton),e=>E=e.default,e=>w=e.default,e=>R=e.default,e=>T=e.default,e=>b=e.default,e=>S=e.useViewportCategory,e=>I=e.default,e=>y=e.default,e=>(f=e.useQuery,k=e.useMutation),e=>N=e.Spinner,e=>(P=e.Modal,A=e.ModalContainer),e=>(M=e.TextArea,O=e.SearchableTextInput),e=>D=e.default,e=>L=e.ChipButton,e=>(U=e.jsx,W=e.Fragment,z=e.jsxs),e=>V=e.default,e=>B=e.default,e=>(x=e.BubbleRatingInput,q=e.BubbleRating),e=>H=e.DropdownMenu,e=>F=e.default,e=>G=e.useDeviceId,e=>j=e.useRoute,e=>K=e.default,e=>Y=e.default,e=>$=e.useDomainName,e=>J=e.Checkbox,e=>Q=e.default,e=>X=e.useUserAgent,e=>Z=e.default]]},["1o4yt4","nbuwox","17thqz","1iahto","tr3542","jppfwt","1qkjm8","wenm84","1essqv","34bu7w","lchj5q","1ys6v1","fkji80","155gpl","1mqwhq","1qndsd","1i3sz5","1u3aio","1ypf49","1b1clj","121h32","1u47wj","1mvpl5","1bkeq2","1ntn26","lr6tb6","p5p2yo","fgwvq1","9btuwa","vfymw1","qlcuu5","frf6ac","p9ucm8","1nnprh","gugp1d"]]);
