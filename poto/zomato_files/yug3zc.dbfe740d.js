(this.$WP=this.$WP||[]).push(["yug3zc",(e,t)=>{"use strict";var i,s,o,a,n,l,r,d,p,c,h,u,g,m,b,v,f,k,_,y,O,N,w,D,T,S,I,P,C,F,A,E,L,x,G,R,M,z,q,B=e=>{A().dispatch(E.page.hotels.setGoogleOneTapOpen(e))},H="EFBLy D G5",U=e=>{var{localize:t}=g();return f(L,{...e,localize:t})},j=({mutation:e,variables:t,onCompleted:i,className:s,children:o,textInputIsValid:a})=>f(T,{query:e,children:({executeMutation:e})=>f("form",{className:s,onSubmit:s=>{s.preventDefault&&s.preventDefault(),a()&&e(t).then((({data:e})=>{i&&i(e)}))},children:o})}),K={__key:0x78187f1ed93b,id:"78187f1ed93b36379ac28f572f118122",loc:{},definitions:[]},V={__key:22284245845108,id:"1444748ec4743acae16c5bcbca3f3b92",loc:{},definitions:[]},Q="homePromptDismissed",W=["CheapFlightsSearchResults","CheapFlightsSearchDeals","MobileCheapFlightsSearchResults","MobileCheapFlightsSearchDeals","OptimusHotelCheckout","OptimusSubscriptionCheckout"],J=e=>{var{localize:t}=g(),i=u("mobile_web"),{params:a}=I(),{newPlusSubscriber:n=!1}=a,l={bottom:"0"},[r,d]=s({type:"location_id",value:"1",displayValue:""}),[p,c]=s(""),[m,_]=s(!1),y=e=>{c(e)},T=e=>{d(e),c(e.value)},P=i?"QjdMj":"JjknH",C=i?"HgGJN":"IEBQA",F={hometown:r.value||null,userId:e.userId},A=t=>{b({module:"Home_Location_Prompt",action:t,context:e.servlet||"unknown"})};return o((()=>{if(e.ipGeoId&&e.ipGeoId>1&&e.ipGeoNameAndParentName&&""!==e.ipGeoNameAndParentName){var t={type:"location_id",value:e.ipGeoId.toString(),displayValue:e.ipGeoNameAndParentName};d(t),c(t.value)}}),[e.ipGeoId,e.ipGeoNameAndParentName]),f(S,{query:V,variables:{userId:e.userId},children:({fetching:s,data:o})=>{var a,d;return s||(t=>{var i,s,o,a,l=!u("home_location_prompt_master"),r=null==t||null==(i=t.memberProfile)||null==(s=i.hometown)?void 0:s.locationId,d=Date.now()-((null==t||null==(o=t.insightProfile)||null==(a=o.uiCardsState)?void 0:a.timestamp)||0)<864e5,p=O.get(Q),c=W.includes(e.servlet);return n||e.isInterstitialOpen||l||r||d||p||c})(o)?null:(m||(A("Shown_Prompt"),_(!0)),e.onShown(),f(R,{variables:F,onCompleted:t=>{var i;"OK"===(null==t||null==(i=t.updateMemberProfile)?void 0:i.status)&&(A("Change_Location"),e.onComplete(!0))},textInputIsValid:()=>r&&""!==r.value&&r.value===p,mutation:K,children:k("div",{className:h("qrKQS D C z",P),style:l,children:[f("span",{className:"OBuqK",children:null!=o&&null!=(a=o.memberProfile)&&a.avatar?f(w,{photo:null==o||null==(d=o.memberProfile)?void 0:d.avatar}):f(D,{name:"member",className:"MOOfE"})}),f(v,{colorVariant:"TA_GRAY_3",onClick:()=>{O.set(Q,!0),A("Closed_Prompt"),e.onDismiss()}}),k("div",{className:C,children:[f("p",{className:"uhaFN",children:t("I_live_in")}),f("p",{className:"mSHxy",children:t("home_location_things_near_you")}),k("div",{className:"Pdntt",children:[f("div",{className:"fzeJB",children:f(N,{className:"igiwF",selectedLocation:r,selectionChanged:T,textInputChanged:y,iconType:"map-pin-fill",mode:"cities",includeWorld:!1,resultsAbove:i,max:i?4:8})}),f("button",{className:"tvQbB",children:f(D,{name:"arrow-right",className:"uYaJY"})})]})]})]})}))}})},Y=[40185,40600],$=e=>f(x,{...e});return[()=>{L=class extends i{constructor(e){super(e),this.onFacebookLoadSdkAndInit=()=>{window.require(["facebook/authutils"],(e=>{e.loadSdkAndInit(this.props.fbSdkUrl,this.props.fbConnectAppId,this.props.fbApiVersion),e.queueForInit(this.onFacebookInit),setTimeout((()=>{this.state.fbSdkInitialized||this.props.triggerNext()}),1e4)}))},this.onFacebookInit=()=>{this.setState({fbSdkInitialized:!0}),window.FB.Event.subscribe("xfbml.render",(()=>{this.trackAction("facebook_onetap_rendered")})),window.FB.getLoginStatus((e=>{"connected"===e.status||"not_authorized"===e.status?this.setState({fbUserLoggedIn:!0}):(this.setState({disabled:!0}),this.props.triggerNext())}))},this.onFacebookLogin=()=>{this.trackAction("facebook_onetap_clicked"),window.FB.getLoginStatus((e=>{if("connected"===e.status){var{authResponse:t}=e;t&&t.accessToken&&this.onFacebookAccountConnected(t.signedRequest)}}))},this.onFacebookAccountConnected=e=>{var t=this.parseFBSignedRequest(e);t&&t.code&&(c.set("FacebookAuthCode2",t.code,{expires:new Date((new Date).getTime()+5e3),domain:this.props.cookieDomain,path:"/"}),window.require(["ta/registration/RegOverlay"],(e=>{var t="MOBILE"===this.props.viewportCategory;e.showRegOverlay(null,null,t,{flow:"FACEBOOK_ONETAP",pid:40600,userRequestedForce:"true",extraQueryParams:{social:"true"},displayOnShowOverlay:!0,onClose:()=>{this.dismissFbOneTap()},onSuccess:e=>{this.disableFbOneTap(),e&&e.user_id&&(this.props.trackWouldOpenExplicitPreferences&&this.props.trackWouldOpenExplicitPreferences(),this.props.explicitPreferencesEnabled&&this.props.openExplicitPreferences&&this.props.openExplicitPreferences())}})})))},this.parseFBSignedRequest=e=>{if(!e)return null;var t=e.split(".",2)[1];if(t){var i=atob(t);try{return JSON.parse(i)}catch(e){this.trackAction("facebook_onetap_parseSignedRequestFailed")}}return null},this.dismissFbOneTap=()=>{this.disableFbOneTap(),this.trackAction("facebook_onetap_closed"),this.props.onDismiss()},this.disableFbOneTap=()=>{this.state.disabled||this.setState({disabled:!0})},this.state={fbSdkInitialized:!1,fbUserLoggedIn:!1,disabled:!u("facebook_onetap_mobile")&&!u("facebook_onetap_desktop")}}UNSAFE_componentWillMount(){this.state.disabled&&this.props.triggerNext()}componentDidMount(){this.state.disabled?this.props.triggerNext():(this.trackAction("facebook_onetap_requested"),u("hr_defer_facebook_sdk")||u("h_defer_facebook_sdk")?m("TimeToInteractive").on("TimeToInteractive",this.onFacebookLoadSdkAndInit):this.onFacebookLoadSdkAndInit())}trackAction(e){b({module:"facebook_onetap",action:e,context:`${this.props.servlet||"unknown"}`})}render(){if(this.state.disabled||!this.state.fbSdkInitialized||!this.state.fbUserLoggedIn)return null;var e={headline:this.props.localize("onetap_message_unlock"),subhead:this.props.localize("onetap_subhead_signin_alerts_deals")};return window.onFacebookOneTapLogin=this.onFacebookLogin,setTimeout((()=>{window.FB.XFBML.parse()}),50),k("div",{className:"MOBILE"===this.props.viewportCategory?h(H,"oGkYP"):h(H,"OreYU"),style:{bottom:"MOBILE"===this.props.viewportCategory?"0px":"unset"},children:[f(v,{onClick:this.dismissFbOneTap}),k("div",{className:"FiNTf",children:[f("div",{className:"LXjtq",children:f("div",{children:e.headline})}),f("p",{className:"HrwOT",children:e.subhead}),f("div",{className:"PRSoH",children:f("div",{className:"PtPgu",children:f("div",{className:"fb-login-button","data-width":"100%","data-max-rows":"1","data-size":"large","data-button-type":"continue_with","data-show-faces":"true","data-auto-logout-link":"false","data-use-continue-as":"true","data-scope":"email,user_hometown,user_friends,user_likes,user_location,user_status,user_photos","data-onlogin":"window.onFacebookOneTapLogin();",style:{width:"100%"}})})}),f("div",{className:"oVZqb",children:f("span",{dangerouslySetInnerHTML:{__html:this.props.localize.string("terms_and_policy_links",{0:"/pages/terms.html",1:"/pages/privacy.html",2:"legalLink"})}})})]})]})}},G=p((e=>({fbApiVersion:e.auth.fbApi.apiVersion,fbConnectAppId:e.auth.fbApi.facebookConnectAppId,fbSdkUrl:e.auth.fbApi.sdkUrl,servlet:e.meta.initialServletName,cookieDomain:e.meta.cookieDomain,viewportCategory:e.meta.device.viewportCategory})))(U),j.defaultProps={onCompleted:()=>{},className:"",children:null},R=j,M=l(((e,t)=>{var i=t("/data/1.0/homelocation/ipGeoInfo");return()=>{var t=i&&i.get().data;return{servlet:e.meta.initialServletName,userId:e.auth.loggedInUserId,viewportCategory:e.meta.device.viewportCategory,ipGeoId:null==t?void 0:t.ipGeoId,ipGeoNameAndParentName:null==t?void 0:t.ipGeoNameAndParentName,isInterstitialOpen:e.page.isInterstitialOpen}}}))(J),z=n((()=>t("1j3bsm"))),x=class extends i{constructor(e){super(e),this.onGoogleOneTapDismiss=()=>{P(this.props.sessionId),B(!1)},this.onGoogleOneTapTriggerNext=()=>{this.setState({dialogType:"FACEBOOK_ONETAP"})},this.onFacebookOneTapDismiss=()=>{P(null)},this.onFacebookOneTapTriggerNext=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationDismiss=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationComplete=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationShown=()=>{m("home-location-prompt").emit("shown")},this.onRegistrationOverlayShown=(e,t)=>{Y.includes(t)||this.setState({dialogsDisabled:!0})},this.setupRegDialog=()=>{if(m("Onboarding").on("loginSuccess",this.disableDialog),m("registration-overlay").on("shown",this.onRegistrationOverlayShown),m("FlightList").on("AirwatchInterstitialOpened",this.disableDialog),C.includes(this.props.servlet)||"ShowUserReviews"===this.props.servlet||"MobileShowUserReviews"===this.props.servlet){if(m("DatePicker").on("clicked",this.disableDialog),m("global-nav").on("sidebarOpened",this.disableDialog),m("hotels-sort-filter-entry").on("openSort",this.disableDialog),m("hotels-sort-filter-entry").on("openFilters",this.disableDialog),m("hr-persistent-footer").on("show",this.disableDialog),m("h-map").on("open-trigger-clicked",this.disableDialog),m("h-map").on("toggle-trigger-clicked",this.disableDialog),m("rooms-guests").on("popped",this.disableDialog),this.props.defaultDates&&!y.wasDismissed(this.props.detailPage)&&"MOBILE"===this.props.viewportCategory)return m("rooms-guests").on("firstUserUpdate",this.enableDialog),m("picker-autoadvance").on("flow-complete",this.enableDialog),void m("pop-calendar").on("dismissed",this.enableDialog);m("responsiveStayDates").on("calendarInteracted",this.disableDialog)}u("disable_reg_dialog_for_hardgate")&&"GOOGLE_ONETAP"===this.initialDialogType&&this.props.isGatingPageCountTriggerReached?this.disableDialog():this.enableDialog()},this.initialDialogType=void 0,this.decideInitialDialogType=()=>{var e=!this.props.isMember&&!F(this.props.sessionId),t=this.props.isMember,i="NONE";return e?i="GOOGLE_ONETAP":t&&(i="HOME_LOCATION_PROMPT"),i},this.enableDialog=()=>{"NONE"===this.state.dialogType&&this.setState({dialogType:this.initialDialogType})},this.disableDialog=()=>{"NONE"!==this.state.dialogType&&this.setState({dialogType:"NONE",dialogsDisabled:!0})},this.state={dialogType:"NONE",dialogsDisabled:!1}}componentDidMount(){this.initialDialogType=this.decideInitialDialogType(),"NONE"!==this.initialDialogType?this.setupRegDialog():m("reg_dialog").emit("all_dismissed")}componentDidUpdate(e){!e.isMember&&this.props.isMember&&this.disableDialog()}render(){var{dialogsDisabled:e,dialogType:t}=this.state,i=()=>null,s=[],o="registration_dialog";if(e)return null;switch(t){case"GOOGLE_ONETAP":s=["google_one_tap"],i=({dismiss:e})=>f(a,{children:f(z,{onDismiss:()=>{e(),this.onGoogleOneTapDismiss()},onShow:()=>B(!0),triggerNext:this.onGoogleOneTapTriggerNext,servletName:this.props.servlet})}),o="google_one_tap";break;case"FACEBOOK_ONETAP":s=["facebook_one_tap"],i=({dismiss:e})=>f(G,{onDismiss:()=>{e(),this.onFacebookOneTapDismiss()},triggerNext:()=>{e(),this.onFacebookOneTapTriggerNext()}}),o="facebook_one_tap"}var n=null,l=null;return this.props.isDatePickerPage||(n=f(r,{factory:()=>null,eventTypes:[],renderKey:"skip_100",tier:100,skip:!0}),l=f(r,{factory:()=>null,eventTypes:[],renderKey:"skip_50",tier:50,skip:!0})),"HOME_LOCATION_PROMPT"===t?k(_,{children:[n,l,f(M,{onDismiss:this.onHomeLocationDismiss,onShown:this.onHomeLocationShown,onComplete:this.onHomeLocationComplete})]}):this.props.isMember||F(this.props.sessionId)||this.props.isPaywallBlocking?k(_,{children:[l,n,f(r,{factory:i,eventTypes:["skip_200"],renderKey:"skip_200",tier:200,skip:!0})]}):s.length>0?k(_,{children:[l,n,f(r,{factory:i,eventTypes:s,renderKey:o,tier:200})]}):null}},q=l({data:(e,t)=>(M.stage(e,t),()=>{var t,i,s,o,a;return{isMember:e.auth.isMember,isDatePickerPage:e.page.isDatePickerPage,isPaywallBlocking:e.page.isPaywallBlocking,sessionId:e.tracking.sessionId,viewportCategory:e.meta.device.viewportCategory,servlet:e.meta.initialServletName,defaultDates:!!(e.travelerInfo.hotels||{}).defaultDates,detailPage:!(null==(t=e.page)||!t.detailId),isGatingPageCountTriggerReached:d((null==(i=e.lithiumRoute)||null==(s=i[0])?void 0:s.page)||"Unknown",(null==(o=e.lithiumRoute)||null==(a=o[0])?void 0:a.params)||{})}}),actions:{}})($),e("default",q)},[e=>(i=e.Component,s=e.useState,o=e.useEffect,a=e.Suspense,n=e.lazy),e=>l=e.bind,e=>r=e.PopupHierarchyRender,e=>d=e.pageCountTriggerReached,e=>p=e.connect,e=>c=e.default,e=>h=e.default,e=>u=e.featureIsEnabled,e=>g=e.useLocalize,e=>m=e.createRadio,e=>b=e.default,e=>v=e.CloseIcon,e=>(f=e.jsx,k=e.jsxs,_=e.Fragment),e=>y=e.default,e=>O=e.default,e=>N=e.GeoSelector,e=>w=e.Avatar,e=>D=e.Icon,e=>(T=e.Mutation,S=e.Query),e=>I=e.useRoute,e=>(P=e.setRegDialogDismissed,C=e.HOTEL_SERVLETS,F=e.shouldSuppressRegistrationDialog),e=>(A=e.getStore,E=e.actions)]]},["1o4yt4","16z5q2","18pymb","igyuz7","12mj4n","5gpqhx","fkji80","skjzuv","17thqz","1bqgab","4axon3","1uzmmz","121h32","losr6p","19b9b1","1uaudg","dl4tf4","1ybxsm","1mqwhq","fgwvq1","cyrz7y","45ddp0"]]);
